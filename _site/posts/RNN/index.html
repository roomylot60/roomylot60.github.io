<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="ko" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >
  <!-- MathJax 추가 -->
  <script type="text/javascript" async
  src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Concept of Recurrent Neural Network" />
<meta name="author" content="Patrick" />
<meta property="og:locale" content="ko" />
<meta name="description" content="Recurrent Neural Network; RNN RNN(순환 신경망) 입력과 출력을 Sequence 단위로 처리하는 인공 신경망 모델 FFNN : 은닉층에서 활성화 함수를 거친 값이 출력층 방향으로만 진행 RNN : 은닉층에서 활성화 함수(tanh를 주로 사용)를 거친 값이 출력층 혹은 은닉층 노드로 진행 {% include figure.html path=&quot;assets/img/nlp/Pasted%20image%2020240107170727.png&quot; class=&quot;img-fluid rounded z-depth-1&quot; zoomable=true %} {% include figure.html path=&quot;assets/img/nlp/Pasted%20image%2020240107171654.png&quot; class=&quot;img-fluid rounded z-depth-1&quot; zoomable=true %}" />
<meta property="og:description" content="Recurrent Neural Network; RNN RNN(순환 신경망) 입력과 출력을 Sequence 단위로 처리하는 인공 신경망 모델 FFNN : 은닉층에서 활성화 함수를 거친 값이 출력층 방향으로만 진행 RNN : 은닉층에서 활성화 함수(tanh를 주로 사용)를 거친 값이 출력층 혹은 은닉층 노드로 진행 {% include figure.html path=&quot;assets/img/nlp/Pasted%20image%2020240107170727.png&quot; class=&quot;img-fluid rounded z-depth-1&quot; zoomable=true %} {% include figure.html path=&quot;assets/img/nlp/Pasted%20image%2020240107171654.png&quot; class=&quot;img-fluid rounded z-depth-1&quot; zoomable=true %}" />
<link rel="canonical" href="http://localhost:4000/posts/RNN/" />
<meta property="og:url" content="http://localhost:4000/posts/RNN/" />
<meta property="og:site_name" content="Patrick’s Dev. Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-05T18:40:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Concept of Recurrent Neural Network" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="twitter:creator" content="@Patrick" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Patrick"},"dateModified":"2023-11-05T18:40:00+09:00","datePublished":"2023-11-05T18:40:00+09:00","description":"Recurrent Neural Network; RNN RNN(순환 신경망) 입력과 출력을 Sequence 단위로 처리하는 인공 신경망 모델 FFNN : 은닉층에서 활성화 함수를 거친 값이 출력층 방향으로만 진행 RNN : 은닉층에서 활성화 함수(tanh를 주로 사용)를 거친 값이 출력층 혹은 은닉층 노드로 진행 {% include figure.html path=&quot;assets/img/nlp/Pasted%20image%2020240107170727.png&quot; class=&quot;img-fluid rounded z-depth-1&quot; zoomable=true %} {% include figure.html path=&quot;assets/img/nlp/Pasted%20image%2020240107171654.png&quot; class=&quot;img-fluid rounded z-depth-1&quot; zoomable=true %}","headline":"Concept of Recurrent Neural Network","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/RNN/"},"url":"http://localhost:4000/posts/RNN/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Concept of Recurrent Neural Network | Patrick's Dev. Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Patrick's Dev. Blog">
<meta name="application-name" content="Patrick's Dev. Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="https://chirpy-img.netlify.app/assets/img/profile.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Patrick's Dev. Blog</a>
    <p class="site-subtitle fst-italic mb-0">이것 저것 해보는 중입니다</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/roomylot60"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/twitter_username"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['min2max.dev','google.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Concept of Recurrent Neural Network</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Concept of Recurrent Neural Network</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1699177200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Nov  5, 2023
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1815 words"
>
  <em>10 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Concept of Recurrent Neural Network</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Concept of Recurrent Neural Network</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="recurrent-neural-network-rnn"><span class="me-2">Recurrent Neural Network; RNN</span><a href="#recurrent-neural-network-rnn" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="rnn순환-신경망"><span class="me-2">RNN(순환 신경망)</span><a href="#rnn순환-신경망" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>입력과 출력을 Sequence 단위로 처리하는 인공 신경망 모델
    <ul>
      <li>FFNN : 은닉층에서 활성화 함수를 거친 값이 출력층 방향으로만 진행</li>
      <li>RNN : 은닉층에서 활성화 함수(<code class="language-plaintext highlighter-rouge">tanh</code>를 주로 사용)를 거친 값이 출력층 혹은 은닉층 노드로 진행<br /></li>
    </ul>
  </li>
</ul>
<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/nlp/Pasted%20image%2020240107170727.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/nlp/Pasted%20image%2020240107171654.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>

<h4 id="memory-cell-rnn-cell"><span class="me-2">Memory Cell; RNN Cell</span><a href="#memory-cell-rnn-cell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
  <li>은닉층에서 activation function을 거친 값을 내보내면서 이전 시점의 값을 기억하고 이를 입력으로 사용하는 노드</li>
  <li>Hidden State : t시점의 메모리 셀이 t+1 시점으로 보내는 값<br /></li>
</ul>
<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/nlp/Pasted%20image%2020240107171339.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>

<ul>
  <li>RNN Architecture : 각 시점에서 입력과 출력이 동시 혹은 하나만 이루어지는 지에 따라 모델의 종류(구조)가 변함<br /></li>
</ul>
<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/nlp/rnn_models.jpg" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>structure</th>
      <th>example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>One-to-Many</td>
      <td>Image Captioning</td>
    </tr>
    <tr>
      <td>Many-to-One</td>
      <td>Sentiment Classification, Spam Detection</td>
    </tr>
    <tr>
      <td>Many-to-Many</td>
      <td>Chatbot, Translator, Tagging task</td>
    </tr>
  </tbody>
</table></div>

<h4 id="rnn-code-with-keras-and-python"><span class="me-2">RNN Code with Keras and Python</span><a href="#rnn-code-with-keras-and-python" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="c1"># Keras를 사용하여 RNN 생성
</span><span class="kn">from</span> <span class="n">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">SimpleRNN</span>

<span class="c1"># 추가 인자를 활용한 RNN layer 생성
</span><span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">SimpleRNN</span><span class="p">(</span><span class="n">hidden_units</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">)))</span>

<span class="c1"># model.add(SimpleRNN(hidden_units, input_length=M, input_dim=N)) # 다른 표기
</span></code></div></div>

<ul>
  <li>hidden_units : 은닉 상태의 크기(RNN의 용량)을 정의; 메모리 셀이 다음 시점의 메모리 셀과 출력층으로 보내는 값의 크기(ouptut_dim)</li>
  <li>Input : 3D tensor로 입력
    <ul>
      <li>batch_size : 한번에 학습하는 데이터의 수; sample의 수</li>
      <li>input_dim : 입력 벡터의 차원 수;입력 단어 하나의 길이</li>
      <li>timesteps : 입력 시퀀스의 길이(input_length);각 시점에서 단어 하나를 입력으로 받기에, 단어의 모음인 시퀀스의 길이라고 할 수 있음</li>
    </ul>
  </li>
  <li>Output : return_sequences의 값에 따라 2D, 3D 결정
    <ul>
      <li>batch_size</li>
      <li>output_dim : 최종 시점의 은닉 상태인 출력 벡터의 차원 수;출력 단어 하나의 길이</li>
      <li>timesteps : 메모리 셀의 각 시점의 은닉 상태값(hidden states)</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="c1"># Python으로 직접 RNN 구성
</span><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">timestpes</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Sequence의 길이
</span><span class="n">input_dim</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># 단어 벡터의 차원
</span><span class="n">hidden_units</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1"># 은닉 상태의 크기 = 메모리 셀의 용량
</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">((</span><span class="n">timestpes</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">))</span>
<span class="n">hidden_state_t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">hidden_units</span><span class="p">,))</span> <span class="c1"># 초기 은닉 상태 초기화
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Initial Hidden States :</span><span class="sh">"</span><span class="p">,</span> <span class="n">hidden_state_t</span><span class="p">)</span>

<span class="n">Wx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">((</span><span class="n">hidden_units</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">))</span> <span class="c1"># 입력에 대한 가중치 2D 텐서 생성
</span><span class="n">Wh</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">((</span><span class="n">hidden_units</span><span class="p">,</span> <span class="n">hidden_units</span><span class="p">))</span> <span class="c1"># 은닉 상태에 대한 가중치 2D 텐서 생성
</span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">((</span><span class="n">hidden_units</span><span class="p">,))</span> <span class="c1"># bias 생성
</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Wx, Wh, b : {}</span><span class="se">\n\n</span><span class="s">{}</span><span class="se">\n\n</span><span class="s">{}</span><span class="se">\n\n</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">Wx</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Wx, Wh, b shapes : </span><span class="sh">"</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">Wx</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">Wh</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>

<span class="n">total_hidden_states</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># 모든 시점의 은닉 상태
</span>
<span class="c1"># dot(arr1, arr2) : 벡터 계산 (arr1, arr2의 원소값들의 곱의 합)
</span><span class="k">for</span> <span class="n">input_t</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
    <span class="n">output_t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">tanh</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Wx</span><span class="p">,</span> <span class="n">input_t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">hidden_state_t</span><span class="p">))</span>
    <span class="n">total_hidden_states</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">output_t</span><span class="p">))</span>

<span class="n">total_hidden_states</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">stack</span><span class="p">(</span><span class="n">total_hidden_states</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">total_hidden_states</span><span class="p">)</span>
</code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>Initial : <span class="o">[</span>0. 0. 0. 0. 0. 0. 0. 0.]
Wx, Wh, b : <span class="o">[[</span>0.85143664 0.97714713 0.65502162 0.28371238]
 <span class="o">[</span>0.30802615 0.09059362 0.1076857  0.25372438]
 <span class="o">[</span>0.28704896 0.60082044 0.75228122 0.68312046]
 <span class="o">[</span>0.68097992 0.80925337 0.0645649  0.12324691]
 <span class="o">[</span>0.38990914 0.92962164 0.10098862 0.67962663]
 <span class="o">[</span>0.94462422 0.01337485 0.03662331 0.03050986]
 <span class="o">[</span>0.28653855 0.32739224 0.49828274 0.82087065]
 <span class="o">[</span>0.96042989 0.83653596 0.07487261 0.09113481]]

<span class="o">[[</span>0.68096678 0.58803731 0.57988288 0.92890096 0.09135938 0.99057804
  0.01872872 0.4546827 <span class="o">]</span>
 <span class="o">[</span>0.13087967 0.76399839 0.56236402 0.69592914 0.36460709 0.72990083
  0.45858138 0.00552776]
 <span class="o">[</span>0.55843321 0.64096323 0.53645843 0.79040003 0.42508579 0.30223451
  0.5627866  0.86003013]
 <span class="o">[</span>0.4413374  0.97321599 0.84578887 0.25420944 0.73637994 0.391908
  0.17252162 0.76213319]
 <span class="o">[</span>0.06361856 0.73890545 0.58717524 0.45134905 0.05404353 0.4730816
  0.55602838 0.81121357]
 <span class="o">[</span>0.56893496 0.79008566 0.87842282 0.00705078 0.06712543 0.27438764
  0.40791329 0.50191709]
 <span class="o">[</span>0.18485617 0.67680875 0.32107997 0.67353141 0.58586511 0.80557961
  0.9308333  0.33228672]
 <span class="o">[</span>0.58482391 0.67038387 0.61891013 0.40433411 0.7752712  0.49077138
  0.22612616 0.23695048]]

<span class="o">[</span>0.77085078 0.46451979 0.05440115 0.82049665 0.09553835 0.78358678
 0.47607443 0.87411462]


Wx, Wh, b shapes :  <span class="o">(</span>8, 4<span class="o">)</span> <span class="o">(</span>8, 8<span class="o">)</span> <span class="o">(</span>8,<span class="o">)</span>


<span class="o">[[</span>0.9311158  0.28819712 0.81778765 0.79569775 0.80725949 0.42711984
  0.64165978 0.84558929]
 <span class="o">[</span>0.93584739 0.33438469 0.79853643 0.8403642  0.84959694 0.54169853
  0.64857779 0.88908515]
 <span class="o">[</span>0.89903488 0.45231785 0.85710553 0.67561648 0.77069602 0.63738225
  0.81731435 0.77063852]
 <span class="o">[</span>0.75156127 0.33641803 0.63492503 0.51016977 0.51385085 0.59919868
  0.59905286 0.63723528]
 <span class="o">[</span>0.88905473 0.44012962 0.8013277  0.70813697 0.75661072 0.68661386
  0.76037359 0.80598781]
 <span class="o">[</span>0.95834118 0.44270473 0.89593064 0.82501953 0.8508026  0.65423909
  0.80873311 0.88625939]
 <span class="o">[</span>0.93018297 0.50930848 0.90068338 0.78150259 0.8930009  0.63937644
  0.8779043  0.84691315]
 <span class="o">[</span>0.82701004 0.24378468 0.78295419 0.45492988 0.48932459 0.31174412
  0.63485924 0.52788644]
 <span class="o">[</span>0.9632202  0.51884557 0.91992141 0.85340389 0.90910772 0.70188364
  0.87507954 0.90729884]
 <span class="o">[</span>0.89504751 0.38634984 0.83208148 0.62738128 0.65260641 0.60001641
  0.74679467 0.73196294]]
</code></div></div>

<h3 id="deep-rnn깊은-순환-신경망"><span class="me-2">Deep RNN(깊은 순환 신경망)</span><a href="#deep-rnn깊은-순환-신경망" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>은닉층의 개수(깊이)가 복수인 경우</li>
</ul>

<h4 id="code"><span class="me-2">Code</span><a href="#code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="nc">Sequential</span><span class="p">()</span>
<span class="c1"># 첫번째 은닉층을 정의할 때, 각 시점의 값을 다음 은닉층으로 값을 전달하기 위해 retrun_sequences 값을 True로 설정
</span><span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">SimpleRNN</span><span class="p">(</span><span class="n">hidden_units</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">SimpleRNN</span><span class="p">(</span><span class="n">hidden_units</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</code></div></div>

<h3 id="bidirectional-rnn양방향-rnn"><span class="me-2">Bidirectional RNN(양방향 RNN)</span><a href="#bidirectional-rnn양방향-rnn" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>시점 t의 출력값을 예측할 때, t 이전 시점의 입력뿐만 아니라, 이후 시점의 입력 또한 예측에 기여할 수 있다는 아이디어 기반 RNN</li>
  <li>기본적으로는 두 개의 메모리 셀을 사용하여 첫 번째에서는 Forward States를, 두 번째에서는 Backward States를 전달 받아 Hidden State를 계산</li>
</ul>

<hr />

<h2 id="rnn-text-classification"><span class="me-2">RNN Text Classification</span><a href="#rnn-text-classification" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ul>
  <li>Binary Classification</li>
  <li>Multi-Class Classification
    <h3 id="text-classification-using-kerassupervised-learning"><span class="me-2">Text Classification using Keras(supervised learning)</span><a href="#text-classification-using-kerassupervised-learning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
  </li>
  <li>Supervised Learning(지도 학습) : Train Data로 Label이라는 정답을 포함하고 있는 Dataset을 사용하여 학습; 정답을 알고 있는 상태로 훈련</li>
  <li>Validation(검증) : 모든 Sample을 사용하여 학습하지 않고 일정 비율의 데이터를 남기고 이를 예측한 뒤 Label 값과 대조하여 검증하는 데 사용</li>
  <li>Embedding : 각각의 단어가 정수로 변환된 값(index)를 입력으로 받아 임베딩 작업을 수행; 인덱싱 작업(정수 인코딩)의 방법 중 하나로는 빈도수에 따라 정렬</li>
  <li>텍스트 분류는 RNN의 Many-to-one 문제에 속하므로, 모든 시점에 대해서 입력을 받지만, 최종시점의 은닉 상태 만을 출력
    <ul>
      <li>Binary Classification : 출력값의 종류가 두 종류일 경우(loss function = binary_crossentropy)</li>
      <li>Multi-Class Classification : 출력값의 종류가 세 가지 이상(loss function : categorical_crossentropy)</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">SimpleRNN</span><span class="p">(</span><span class="n">hidden_units</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">)))</span>
<span class="c1"># hidden_units : RNN 출력의 크기; 은닉 상태의 크기
# timesteps : 시점의 수; 각 문서의 단어 수
# input_dim : 입력의 크기; 임베딩 벡터의 차원
</span></code></div></div>

<h3 id="tagging-task-using-keras"><span class="me-2">Tagging Task using Keras</span><a href="#tagging-task-using-keras" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>지도 학습을 통해 이루어지는 분류 작업
    <h4 id="named-entity-recognition개체명-인식"><span class="me-2">Named Entity Recognition(개체명 인식)</span><a href="#named-entity-recognition개체명-인식" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
  </li>
  <li>이름(의미)을 갖는 개체를 보고 해당 단어(개체)의 유형 파악</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="kn">from</span> <span class="n">nltk</span> <span class="kn">import</span> <span class="n">word_tokenize</span><span class="p">,</span> <span class="n">pos_tag</span><span class="p">,</span> <span class="n">ne_chunk</span>

<span class="n">sentence</span> <span class="o">=</span> <span class="sh">"</span><span class="s">James is working at Disney in London</span><span class="sh">"</span>

<span class="c1"># Tokenize the sentence and tag
</span><span class="n">tokenized_sentence</span> <span class="o">=</span> <span class="nf">pos_tag</span><span class="p">(</span><span class="nf">word_tokenize</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">tokenized_sentence</span><span class="p">)</span>

<span class="c1"># 개체명 인식
</span><span class="n">ner_sentence</span> <span class="o">=</span> <span class="nf">ne_chunk</span><span class="p">(</span><span class="n">tokenized_sentence</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">ner_sentence</span><span class="p">)</span>
</code></div></div>

<h4 id="part-of-speech-tagging품사-태깅"><span class="me-2">Part-of-Speech Tagging(품사 태깅)</span><a href="#part-of-speech-tagging품사-태깅" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
  <li>단어의 품사 파악</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="c1"># Preprocessing
</span><span class="kn">import</span> <span class="n">nltk</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">tensorflow.keras.preprocessing.text</span> <span class="kn">import</span> <span class="n">Tokenizer</span>
<span class="kn">from</span> <span class="n">tensorflow.keras.preprocessing.sequence</span> <span class="kn">import</span> <span class="n">pad_sequences</span>
<span class="kn">from</span> <span class="n">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Tokenized and Tagged Data
</span><span class="n">tagged_sentences</span> <span class="o">=</span> <span class="n">nltk</span><span class="p">.</span><span class="n">corpus</span><span class="p">.</span><span class="n">treebank</span><span class="p">.</span><span class="nf">tagged_sents</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">품사 태깅이 된 문장 개수: </span><span class="sh">"</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">tagged_sentences</span><span class="p">))</span> <span class="c1"># 3914
</span>
<span class="c1"># Diverse data into words and tags
</span><span class="n">sentences</span><span class="p">,</span> <span class="n">pos_tags</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> 
<span class="k">for</span> <span class="n">tagged_sentence</span> <span class="ow">in</span> <span class="n">tagged_sentences</span><span class="p">:</span>
	<span class="n">sentence</span><span class="p">,</span> <span class="n">tag_info</span> <span class="o">=</span> <span class="nf">zip</span><span class="p">(</span><span class="o">*</span><span class="n">tagged_sentence</span><span class="p">)</span> <span class="c1"># as the tagged_sentence shows tuple of word and tag of each sample, so use zip() to seperate them
</span>	<span class="n">sentences</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span>
	<span class="n">pos_tags</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">tag_info</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">tokenize</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
	<span class="n">tokenizer</span> <span class="o">=</span> <span class="nc">Tokenizer</span><span class="p">()</span>
	<span class="n">tokenizer</span><span class="p">.</span><span class="nf">fit_on_texts</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">tokenizer</span>

<span class="n">src_tokenizer</span> <span class="o">=</span> <span class="nf">tokenize</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>
<span class="n">tar_tokenizer</span> <span class="o">=</span> <span class="nf">tokenize</span><span class="p">(</span><span class="n">pos_tags</span><span class="p">)</span>

<span class="n">vocab_size</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">src_tokenizer</span><span class="p">.</span><span class="n">word_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">tag_size</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">tar_tokenizer</span><span class="p">.</span><span class="n">word_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">단어 집합의 크기 : {}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">태깅 정보 집합의 크기 : {}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">tag_size</span><span class="p">))</span>

<span class="c1"># Encoding
</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">src_tokenizer</span><span class="p">.</span><span class="nf">texts_to_sequences</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">tar_tokenizer</span><span class="p">.</span><span class="nf">texts_to_sequences</span><span class="p">(</span><span class="n">pos_tags</span><span class="p">)</span>

<span class="c1"># padding into max length of encoded samples
</span><span class="n">max_len</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="nf">pad_sequences</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="sh">'</span><span class="s">post</span><span class="sh">'</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">max_len</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="nf">pad_sequences</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="sh">'</span><span class="s">post</span><span class="sh">'</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">max_len</span><span class="p">)</span>

<span class="c1"># Generate POS Tagger
</span><span class="kn">from</span> <span class="n">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="n">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">LSTM</span><span class="p">,</span> <span class="n">InputLayer</span><span class="p">,</span> <span class="n">Bidirectional</span><span class="p">,</span> <span class="n">TimeDistributed</span><span class="p">,</span> <span class="n">Embedding</span>
<span class="kn">from</span> <span class="n">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>

<span class="n">embedding_dim</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">hidden_units</span> <span class="o">=</span> <span class="mi">128</span>

<span class="n">model</span> <span class="o">=</span> <span class="nc">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Embedding</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="n">mask_zero</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span> <span class="c1"># Zero padding
</span><span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Bidirectional</span><span class="p">(</span><span class="nc">LSTM</span><span class="p">(</span><span class="n">hidden_units</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">)))</span> <span class="c1"># Many-to-many
</span><span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">TimeDistributed</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="n">tag_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">softmax</span><span class="sh">'</span><span class="p">))))</span>

<span class="n">model</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="sh">'</span><span class="s">sparse_categorical_crossentropy</span><span class="sh">'</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="nc">Adam</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">])</span>
<span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>

<span class="c1"># Testing 
</span><span class="n">index_to_word</span> <span class="o">=</span> <span class="n">src_tokenizer</span><span class="p">.</span><span class="n">index_word</span>
<span class="n">index_to_tag</span> <span class="o">=</span> <span class="n">tar_tokenizer</span><span class="p">.</span><span class="n">index_word</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># 확인하고 싶은 테스트용 샘플의 인덱스.
</span><span class="n">y_predicted</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span> <span class="c1"># 입력한 테스트용 샘플에 대해서 예측값 y를 리턴
</span><span class="n">y_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">y_predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 확률 벡터를 정수 레이블로 변환.
</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">{:15}|{:5}|{}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">"</span><span class="s">단어</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">실제값</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">예측값</span><span class="sh">"</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="mi">35</span> <span class="o">*</span> <span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">pred</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_predicted</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
	<span class="k">if</span> <span class="n">word</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># PAD값은 제외함.
</span>		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">{:17}: {:7} {}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">index_to_word</span><span class="p">[</span><span class="n">word</span><span class="p">],</span> <span class="n">index_to_tag</span><span class="p">[</span><span class="n">tag</span><span class="p">].</span><span class="nf">upper</span><span class="p">(),</span> <span class="n">index_to_tag</span><span class="p">[</span><span class="n">pred</span><span class="p">].</span><span class="nf">upper</span><span class="p">()))</span>
</code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/nlp/">NLP</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/concept/"
            class="post-tag no-text-decoration"
          >Concept</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Concept%20of%20Recurrent%20Neural%20Network%20-%20Patrick's%20Dev.%20Blog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FRNN%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Concept%20of%20Recurrent%20Neural%20Network%20-%20Patrick's%20Dev.%20Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FRNN%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FRNN%2F&text=Concept%20of%20Recurrent%20Neural%20Network%20-%20Patrick's%20Dev.%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Graph/">Graph</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/pip_requiremntes/">Pip_requiremntes</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/BPE/">Bpe</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Huggingface/">Huggingface</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Datasets/">Datasets</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/concept/">Concept</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/grammer/">Grammer</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bfs/">BFS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dfs/">DFS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/graph/">Graph</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/paper/">Paper</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tutorial/">Tutorial</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Attention_Machanism/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1701774720"
  data-df="ll"
  
>
  Dec  5, 2023
</time>

              <h4 class="pt-0 my-2">Attention Algorithm</h4>
              <div class="text-muted">
                <p>Seq2seq based on RNN seq2seq Model : RNN에 기반하여 Encoder에서 입력 시퀀스를 context vector라는 하나의 고정된 크기의 벡터 표현으로 압축하고, Decoder에서 출력 시퀀스를 생성 문제점    하나의 고정된 크기의 벡터에 모든 정보를 압축; 정보 손실이 발생   RNN의 문제점 중 하나인 Vanishi...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Subword_Tokenizer/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1701168600"
  data-df="ll"
  
>
  Nov 28, 2023
</time>

              <h4 class="pt-0 my-2">Subword Tokenizer</h4>
              <div class="text-muted">
                <p>Subword Tokenizer Subword    OOV(Out-Of Vocabulary) : 새로 제시된 단어에 대해 기존의 dictionary 내의 단어가 아닌 경우   Subword : 하나의 단어를 구성하는 더 작은 단위의 의미를 가진 어구   Subword segmenation : 하나의 단어를 여러 서브 워드로 분리해서 단어를 인코딩 및 ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/LSTM/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700556180"
  data-df="ll"
  
>
  Nov 21, 2023
</time>

              <h4 class="pt-0 my-2">Long Short-Term Memory in RNN</h4>
              <div class="text-muted">
                <p>Long Short-Term Memory; LSTM The problem of long-term dependencies    Vanila RNN(기본형 RNN)은 비교적 짧은 시퀀스에 대해서만 효과를 보임(시점이 길어질 수록 앞의 정보가 뒤로 충분히 전달되지 못하는 현상 발생)   LSTM    은닉층의 메모리 셀에 입력 게이트, 망각 게이트, 출력 ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/DL_in_NLP/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>DL in Netural Language Processing</p>
    </a>
  

  
    <a
      href="/posts/CNN/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Definition of convolution and usage in NLP</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/username">Patrick</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/concept/">Concept</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/grammer/">Grammer</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bfs/">BFS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dfs/">DFS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/graph/">Graph</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/paper/">Paper</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tutorial/">Tutorial</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

